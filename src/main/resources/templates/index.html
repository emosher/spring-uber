<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Spring Uber</title>
    <!--ApexCharts v5.3.5-->
    <script src="/js/vendor/apexcharts.min.js"></script>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <div class="container">
        <h1 class="mt-5">Uber pickups in NYC, Sept 2014</h1>
        <h3 class="mt-4">Number of pickups by hour</h3>
        <div class="chart-container">
            <div id="hourlyChart"></div>
        </div>
    </div>
    <script th:inline="javascript">
        const data = /*[[${messages}]]*/ [];
        const hours = data.map(item => item.hour);
        const counts = data.map(item => item.count);

        const options = {
            series: [{
                name: 'Count per Hour',
                data: counts
            }],
            chart: {
                type: 'bar',
                height: 400,
                toolbar: {
                    show: true
                }
            },
            plotOptions: {
                bar: {
                    borderRadius: 4,
                    columnWidth: '70%'
                }
            },
            dataLabels: {
                enabled: false
            },
            colors: ['rgba(54, 162, 235, 0.8)'],
            stroke: {
                show: true,
                width: 2,
                colors: ['rgba(54, 162, 235, 1)']
            },
            xaxis: {
                categories: hours,
                title: {
                    text: 'Hour of Day'
                }
            },
            yaxis: {
                title: {
                    text: 'Count'
                },
                min: 0
            },
            grid: {
                borderColor: '#e7e7e7'
            },
            tooltip: {
                y: {
                    formatter: function (val) {
                        return val + ' pickups'
                    }
                }
            }
        };

        const chart = new ApexCharts(document.querySelector("#hourlyChart"), options);
        chart.render();
    </script>
</body>
</html>